= Fong Yong Jie - Project Portfolio
:site-section: AboutUs
:imagesDir: ../images
:stylesDir: ../stylesheets

== PROJECT: FitBiz

---

== Overview

FitBiz is a desktop fitness business management application. The user interacts with it using a Command Line Interface, and it has a Graphical User Interface created with JavaFX. It is written in Java version 11.

== Summary of contributions

* *Major enhancement*: added *Exercise classes and commands*
** What it does: allows the user to record their client's exercises. The recorded exercises will then be shown in a table for the user to see.
** Justification: This feature improves the product significantly because it is one of the main features of the application. Many other features like showing the client's personal bests and drawing their clients' progression graph rely on having the exercises recorded.
** Highlights: This enhancement affects existing commands and commands to be added in future. It required an in-depth analysis of design alternatives. The implementation too was challenging as it required changes to existing commands.

* *Major enhancement*: hooked many features from Logic to Graphical User Interface
** What it does: features are shown in GUI instead of being shown in text format.  
** Justification: In order for the application to be appealing and user-friendly, the features have to be properly displayed in the GUI. The features include:
. The exercise progession graph +
 It is a graph of the specified exercise after `graph` command. This is one of the features that is proposed to really attract users. It is a step further from the user just recording his clients' exercises and having the user see the progression of his clients over a period of time.
. The client's information displayed after `view-c` command +
We have a separate window to show the detailed client's information. This helps to reduce the clients' information displayed in the `ClientCard` in `ClientListPanel`. The user can see the essential details of each client at a glance and only see the detailed information after a `view-c` command.
. The exercise table done by the client +
The user will be able to see the exercises done by their clients' listed in a table instead of being shown text in the `ResultDisplay`. This provides a better user experience.

** Highlights: This enhancement affects existing commands and commands to be added in future. It required an in-depth analysis of design alternatives. The implementation too was challenging as it required changes to existing commands.

* *Minor enhancement*: refactored the `Storage` component from AB3 to Fitbiz

* *Minor enhancement*: added `Gender` and `Remarks` attributes to `Client`

* *Code contributed*: https://nus-cs2103-ay1920s2.github.io/tp-dashboard/#search=yonggiee&sort=groupTitle&sortWithin=title&since=2020-02-14&timeframe=commit&mergegroup=false&groupSelect=groupByRepos&breakdown=false&tabOpen=true&tabType=authorship&tabAuthor=AaronCQL&tabRepo=AY1920S2-CS2103T-F11-2%2Fmain%5Bmaster%5D[RepoSense]

* *Other contributions*:

** Enhancements to existing features:
*** Wrote test code for exercise classes and commands to improve test coverage. (https://github.com/AY1920S2-CS2103T-F11-2/main/pull/83[83], https://github.com/AY1920S2-CS2103T-F11-2/main/pull/121[121], https://github.com/AY1920S2-CS2103T-F11-2/main/pull/135[135], https://github.com/AY1920S2-CS2103T-F11-2/main/pull/210[210], https://github.com/AY1920S2-CS2103T-F11-2/main/pull/214[214])
** Documentation:
*** Added https://github.com/AY1920S2-CS2103T-F11-2/main/blob/master/docs/UserGuide.adoc#command-summary[command summary]  in User Guide
** Community:
*** PRs reviewed (with non-trivial review comments): https://github.com/AY1920S2-CS2103T-F11-2/main/pull/137[137,] https://github.com/AY1920S2-CS2103T-F11-2/main/pull/225[225]
*** Reported bugs and suggestions for other teams in the class (examples: https://github.com/AY1920S2-CS2103T-F09-2/main/issues/249[249], https://github.com/AY1920S2-CS2103T-F09-2/main/issues/250[250], https://github.com/AY1920S2-CS2103T-F09-2/main/issues/251[251])

== Contributions to the User Guide

|===
|_Given below are sections I contributed to the User Guide. They showcase my ability to write documentation targeting end-users._
|===

include::../UserGuide.adoc[tag=delete]

include::../UserGuide.adoc[tag=dataencryption]

== Contributions to the Developer Guide

|===
|_Given below are sections I contributed to the Developer Guide. They showcase my ability to write technical documentation and the technical depth of my contributions to the project._
|===

=== Exercise Feature --- Yong Jie

This feature allows users to record the exercises done by a client. The exercises are displayed in a table form, after the `view-c` command is called.

==== Implementation

===== Implementation of Exercise class

The `Exercise` class is facilitated by the `UniqueExerciseList`, which is a wrapper class for an `ObservableList` of `Exercise` objects. Each Client contains one `UniqueExerciseList` attribute to keep track of all `Exercises` the client has.

`Exercise` comprises five attributes:

. `ExerciseName`
. `ExerciseDate`
. `ExerciseReps`
. `ExerciseWeight`
. `ExerciseSets`

All instances of `Exercise` of a client will be contained in the client's `UniqueExerciseList`. There is an additional class `PersonalBest` which is also associated to `Exercise`. It is omitted and will discuss in (...) section due to its high significance. Below shows a UML class diagram which shows `Exercise` class interactions.

image::ExerciseClassDiagram.png[]

An important point to note about our implementation of `Exercise` is the method, `isSameExercise()`. We consider two `Exercise` as the same if `isSameExercise()` returns true.

. Executes when adding a new `Exercise` to client's `UniqueExerciseList`. This includes `add-e` and `edit-e`.
. Checks if the new `Exercise` is the same with an existing instance of `Exercise` in the client's `UniqueExerciseList`.
. Two `Exercises` are the same does not mean that they are equal.
Two `Exercise` are equal only if *all* attributes are equal.

Below shows an object diagram of two `Exercises` that will return true for `isSameExercise()`.

image::IsSameExerciseObjectDiagram.png[]

The two `Exercise` only have different values in `ExerciseSets` but equal values in:

. `ExerciseName`
. `ExerciseDate`
. `ExerciseReps`
. `ExerciseWeight`

This implementation is chosen as we felt that the user should increment the value in `ExerciseSets` in the existing `Exercise`. We followed the same idea as in the real life context. Exercises with the same reps and weight can be grouped together as sets.

We do consider that the user might want to record the two instances separately as it might be done at different periods of the day. In the future, when adding a `same Exercise`, we can implement it such that the sets value of the exising `Exercise` gets incremented automatically instead of showing an error. For now, this implementation keeps the exercise table neat and compact for the user.

===== Execution flow of Exercise Commands

The exercise commands edits the client's `UniqueExerciseList`. Currently, there are 3 exercise commands. 

. `add-e` : Adds an exercise to a client
. `edit-e` : Edits a client's exercise
. `delete-e` : Deletes a client's exercise

The commands follow a similar execution flow as other commands.

image::ExerciseCommandActivityDiagram.png[]

. The `FitBizParser` will create the associated exercise command parser. e.g. `AddExerciseCommandParser`
. Using `ParserUtil`, the parser will extract attribute details from the input and create the `Command`. e.g. `AddExerciseCommand`
. The exercise `Command` will be executed and modify the client's `UniqueExerciseList`.
    .. Exceptions like no client being viewed and invalid input are thrown here.
. The change will be reflected in the exercise table in GUI.
. Result box will display success message for the `Command`.

===== Adding an exercise to UniqueExerciseList

When adding a new `Exercise` to `UniqueExerciseList`, it is important which index it is added. This is such that the exercises for the client will be displayed in descending chronological order in the table after a `view-c` command. `TableView` provides sorting for dates. However, having `TableView` to do the sorting would result in mismatch of indexes of the exercises in the `UniqueExerciseList` and in the `TableView`. This will result in problems when using exercise commands that specifies an index like `delete-e`.

To address this problem, a custom insertion sort has been written in UniqueExerciseList, under the `addToSorted()` method. This method will do a single pass of the internal list to insert the element at the correct position. This assumes that the internal list is initially sorted (which it should be, since reading from storage will do an initial sort on it).

We will use an example of a `add-e` command to illustrate the execution of `addToSorted()`. Consider an instance where user inputs `add-e n/pushup d/12-12-2011 reps/20`. The sequence diagram below shows the execution flow when the `AddExerciseCommand` is executed. Details of exception thrown are omitted as this is a postive instance and for simplicity.

image::AddExerciseCommandSequenceDiagram.png[]

`AddExerciseCommand` checks if there is an client being viewed. For this instance, we will consider the positive case where indeed there is a client being viewed. `AddExerciseCommand` will retrieve the client being viewed from the `Model` so that details like the existing exercise list of the client can be obtained. The sequence diagram illustrates the execution flow of addToSorted() to obtain details of the `Exercise` being added and exising `Exercise` in `UniqueExerciseList`.

image::AddExerciseCommandSequenceDiagramPart2.png[]

`UniqueExerciseList` loops through the exercises in the list. and calls `getExerciseDate()` and `getExerciseName`. The `LocalDate` and exercise name in `String` type are then used for comparision. The sequence diagram below illustrates the conditional checks during the comparision.

image::AddExerciseCommandSequenceDiagramPart3.png[]

The conditional checks are such that `UniqueExerciseList` maintain sorted by descending chronological order, followed by alphabetical order for exercises with the same dates.

Below shows a code snippet of the conditional checks in `addToSorted()`.

[.small]
----
int dateComparision = toAddDate.compareTo(currDate);
if (dateComparision > 0) {
    break;
} else if (dateComparision == 0) {
    if (toAddName.compareTo(currName) <= 0) {
        break;
    } else {
        idx++;
    }
} else {
    idx++;
}    
----

`Arrays.sort()` can be used to sort the exercises in `UniqueExerciseList` after every addition. However, the worse case time complexity of `Arrays.sort()` is `O(nlogn)`. This custom insertion sort will guarantee an `O(n)` time complexity to insert the new `Exercise` correctly. This is as efficient as it gets as any insertion will already incur an O(n) time complexity to first check if the internal list contains the same exercise. It is important to keep the time complexity low as clients will have many exercises.

==== Design Considerations

This section explains the our design considerations and analysis for the storage of exercises.

[options='header']
[cols="2,2,2,2"]
|====================
| | Store exercises with client and all clients in one JSON file (chosen) | Store all exercises into a separate JSON file | Store exercises with client but one JSON for each client

| Ease of retrieving / storing
| Easy to link the exercises to the client
| Hard to link the exercises to the client
| Hard to identify which JSON file is for which client

| Separation of data
| Does not keep client and exercise data separate
| Keep client data separate from exercise data
| Does not keep client and exercise data separate +

Might have too many JSON files, one for each client

| Size limit of JSON files
| High chances of having one large JSON file and potentially exceed the size limit of a JSON file
| Low chances of exceeding the size limit of a JSON file
| Low chances of exceeding the size limit of a JSON file

| Separation of concerns
| Non-separate code for reading/storing exercises and clients data 
| Separate code for reading/storing exercises and clients data
| Non-separate ode for reading/storing exercises and clients data

|====================

We decided to use the first approach of storing the exercises with the associated client and have all the clients data in one JSON file. By code wise, each `JsonAdaptedClient` will have a list of `JsonAdaptedExercise`.

image::ClientExerciseStorageClassDiagram.png[]

We want to keep the implementation reading and storing of data simple. The first approach is the most simple. When reading the data, it removes the need to associate the exercises to the client. A client might potentially have a large amount of exercises, resulting in the reading process to be extremely slow. Therefore, a bad user experience.

Moreover, storing the exercise data from client data does not provide any performance benefits. Due to time constraints, we decided that the application should store all the data everytime it closes. This is regardless if the particular exercise or client data has been changed. Having to keep track of which data is edited and only overwrite those data would greatly increase the complexity of the application. Therefore, keeping exercises data separate from client data would be unnecessary and provide little additional functionality/benefits to the user.

Lastly, we foresee that it is improbable for the data size of both clients and exercises to exceed the maximum size limit of a JSON file. With the target user in mind, it is unlikely that he will have an enormous amount of clients as he will have to cater time for each of them. Even though each client might have many exercises, the information of each exercise is relatively small. For now, collectively, the client and exercise data is unlikely to exceed the JSON size limit. We might consider to have multiple JSON files if the data size gets too big in future versions.

Indeed, `JsonAdaptedClient` having a list of `JsonAdaptedExercise` would violate separation of concerns. `JsonAdaptedClient` is now in-charge of the client's information and the exercises he did. However, we felt that the benefits outweighted the costs and proceeded with the first choice.

include::../DeveloperGuide.adoc[tag=undoredo]

include::../DeveloperGuide.adoc[tag=dataencryption]
